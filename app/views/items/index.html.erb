<div class="row justify-content-center text-center mt-3">
  <h2>持ち物一覧</h2>
</div>

<%= form_with url: group_bulk_update_item_checks_path(@group.id), method: :patch, local: true do |f| %>
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <h5 class="card-title text-center mb-3">持ち物チェック表</h5>

      <table class="table table-bordered table-striped text-center align-middle">
        <thead class="table-primary">
          <tr>
            <th>持ち物</th>
            <% @group.users.each do |user| %>
              <th><%= user.name %></th>
            <% end %>
          </tr>
        </thead>

        <tbody>
          <% @items.each do |item| %>
            <tr>
              <td class="fw-bold"><%= item.name %></td>
              <% @group.users.each do |user| %>
                <% item_check = ItemCheck.find_by(item: item, user: user) %>
                <td>
                  <%= f.check_box "item_checks[][id]",
                        { checked: item_check.is_ok, class: "form-check-input" },
                        item_check.id,
                        nil %>
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>

      <div class="text-center mt-3">
        <%= f.submit "チェックを更新", class: "btn btn-primary px-4" %>
      </div>
    </div>
  </div>
<% end %>

<!-- 持ち物追加フォーム -->
<div class="card shadow-sm">
  <div class="card-body">
    <h5 class="card-title mb-3">持ち物を追加</h5>
    <%= form_with model: Item.new, url: group_items_path(@group), local: true do |f| %>
      <div class="input-group">
        <%= f.text_field :name, placeholder: "新しい持ち物", class: "form-control" %>
        <button type="submit" class="btn btn-outline-primary">追加</button>
      </div>
    <% end %>
  </div>
</div>


<div class="row justify-content-center text-center">
  <div class="col-12">
    <%= link_to "グループに戻る", group_path(@group.id), class: "btn btn-outline-secondary mt-3 btn-block" %>
  </div>
</div>